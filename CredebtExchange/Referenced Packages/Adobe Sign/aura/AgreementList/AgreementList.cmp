<aura:component controller="echosign_dev1.AgreementComponentController"
    implements="force:appHostable,flexipage:availableForAllPageTypes,force:hasRecordId"
    description="Represents an agreement component."
    extensible="true"
    access="global">
    
	<link href='/resource/echosign_dev1__SLDS/SLDS/assets/styles/salesforce-lightning-design-system-vf.css' rel="stylesheet"/>
    
    <ltng:require scripts="/resource/echosign_dev1__jqueryui1111/jquery-ui-1.11.1/external/jquery/jquery.js,/resource/echosign_dev1__jqueryui1111/jquery-ui-1.11.1/jquery-ui.min.js" afterScriptsLoaded="{!c.afterScriptsLoaded}"/>   	

    <aura:handler name="init" value="{!this}" action="{!c.doInit}" />
    
    <aura:attribute name="recentResult" type="echosign_dev1.RecordAgreementDataResult" default="" />
    <aura:attribute name="recordFieldName" type="String" />
    <aura:attribute name="masterObjectNamePlural" type="String" default="" />
    <aura:attribute name="masterRecordName" type="String" default="" />
    <aura:attribute name="isLoading" type="Boolean" default="true" />
    <aura:attribute name="settingsWrapper" type="echosign_dev1.SettingsWrapper" />
    
    <div onclick="{!c.initPageCustom}" class="slds slds-p-around--xx-large slds-container--large slds-container--center">
    	<div class="esign-big-buffer-bottom">
        <aura:if isTrue="{! v.isLoading }">
        	<div class="slds-grid slds-grid--align-center slds-m-vertical--large">
            	<div class="slds-spinner--large slds-m-vertical--large">
                	<img src="/resource/echosign_dev1__SLDS/SLDS/assets/images/spinners/slds_spinner_brand.gif" alt="Loading..." />
            	</div>
        	</div>
		</aura:if>
        <aura:if isTrue="{! !v.isLoading }">
    		<div class="slds-page-header" role="banner">
            	<!-- <nav class="slds-m-bottom- -xx-small" role="navigation">
                    <p id="bread-crumb-label" class="slds-assistive-text">You are here:</p>
                    <ol class="slds-breadcrumb slds-list- -horizontal" aria-labelledby="bread-crumb-label">
                    	<li class="slds-list__item slds-text-heading- -label"><a href="#">{! v.masterObjectNamePlural }</a></li>
                    	<li class="slds-list__item slds-text-heading- -label"><a href="#">{! v.masterRecordName }</a></li>
                    </ol>
              	</nav> -->
                <div class="slds-grid">
                	<div class="slds-col slds-has-flexi-truncate">
                    	<h1 class="slds-text-heading--medium slds-truncate" title="Contacts (will truncate)">Agreements</h1>
                    </div>
               	</div>
              	<p class="slds-text-body--small slds-m-top--x-small">{! v.recentResult.agreementWrappers.length } items - Sorted by Date Sent</p>
           	</div>
            <div aura:id="agreementActionDropdown" class="slds-grid slds-grid--align-left">
                <table class="slds-table slds-table--bordered">
                    <thead>
                        <tr class="slds-text-heading--label">
                            <th class="slds-is-sortable" scope="col">
                                <span class="slds-truncate">{! $Label.echosign_dev1.Agreements_Panel_Agreement_Name_Column_Label }</span>
                            </th>
                            <th scope="col">
                                <span class="slds-truncate">{! $Label.echosign_dev1.Agreements_Panel_Recipient_Column_Label }</span>
                            </th>
                            <th scope="col">
                                <span class="slds-truncate">{! $Label.echosign_dev1.Agreements_Panel_Date_Column_Label }</span>
                            </th>
                            <th scope="col">
                                <span class="slds-truncate">{! $Label.echosign_dev1.Agreements_Panel_Status_Column_Label }</span>
                            </th>
                            <th class="slds-row-action" scope="col">
                            </th>
                        </tr>
                    </thead>
                    <tbody>
                        <aura:iteration items="{!v.recentResult.agreementWrappers}" var="agreementWrapper">
                            <tr class="slds-hint-parent">
                                <th data-label="agreement-name" role="row"><a data-order="{! agreementWrapper.agreement.Id }" onclick="{! c.onAgreementEdit }" class="slds-truncate">{! agreementWrapper.agreement.Name }</a></th>
                                <td data-label="account">{! agreementWrapper.firstRecipientName }</td>
                                <td data-label="activity">
                                    <span class="slds-truncate">{! agreementWrapper.createdDateFormatted }</span>
                                </td>
                                <td data-label="stage">
                                    <aura:if isTrue="{! agreementWrapper.isCompletedStatus }">
                                        <span class="slds-truncate esign-out-completed">{! agreementWrapper.agreement.echosign_dev1__Status__c }</span>
                                    </aura:if>
                                    <aura:if isTrue="{! agreementWrapper.isTerminatedStatus }">
                                        <span class="slds-truncate esign-out-terminated">{! agreementWrapper.agreement.echosign_dev1__Status__c }</span>
                                    </aura:if>
                                    <aura:if isTrue="{! agreementWrapper.isInFlightStatus }">
                                        <span class="slds-truncate esign-out-status">{! agreementWrapper.agreement.echosign_dev1__Status__c }</span>
                                    </aura:if>
                                    <aura:if isTrue="{! agreementWrapper.isNotSentStatus }">
                                        <span class="slds-truncate">{! agreementWrapper.agreement.echosign_dev1__Status__c }</span>
                                    </aura:if>
                                </td>
                                <td class="slds-row-action">
                                   	<button onclick="{!c.toggleAgreementAction}" id="{! 'agreementActionButton' + agreementWrapper.agreement.Id }" data-order="{! agreementWrapper.agreement.Id }" class="slds-m-bottom--large esign-menu-action-button">
                                    	<!-- <c:svgIcon dataOrder="{! agreementWrapper.agreement.Id }" otherClasses="esign-menu-action-down" class="slds-button__icon- -x-small" svgPath="/resource/echosign_dev1__SLDS/SLDS/assets/icons/utility-sprite/svg/symbols.svg#down" category="utility" size="small" name="down" /> -->
                                        <img data-order="{! agreementWrapper.agreement.Id }" class="esign-menu-action-down slds-button__icon--small" src="/resource/echosign_dev1__SLDS/SLDS/assets/icons/utility/down_60.png" alt="" />
                                        <!-- <span data-order="{! agreementWrapper.agreement.Id }" class="slds-assistive-text">Show More</span> -->
                                    </button>
                                    <div id="{! 'agreementActionDropdown' + agreementWrapper.agreement.Id }" class="esign-agreement-action-inline-dropdown slds-dropdown slds-dropdown--left slds-dropdown--small slds-dropdown--menu slds-hide">
                                        <ul class="slds-dropdown__list" role="menu">
                                            <li id="menu-0-0" class="slds-dropdown__item" role="menuitem option" tabindex="0"><a data-order="{! agreementWrapper.agreement.Id }" onclick="{! c.onAgreementEdit }" tabindex="-1" class="slds-truncate" >Edit</a></li>
                                            <aura:if isTrue="{! agreementWrapper.isInFlightStatus }">
                                                <li id="menu-2-2" class="slds-dropdown__item" role="menuitem option" tabindex="-1"><a data-order="{! agreementWrapper.agreement.Id }" onclick="{! c.onAgreementHost }" tabindex="-1" class="slds-truncate">Host Signing</a></li>
                                            </aura:if>
                                            <aura:if isTrue="{! and( v.settingsWrapper.toolbarSettings.echosign_dev1__Send_Reminder__c, agreementWrapper.isInFlightStatus ) }">
                                                <li id="menu-2-2" class="slds-dropdown__item" role="menuitem option" tabindex="-1"><a data-order="{! agreementWrapper.agreement.Id }" onclick="{! c.onAgreementRemind }" tabindex="-1" class="slds-truncate">Send Reminder</a></li>
                                            </aura:if>
                                            <aura:if isTrue="{! and( v.settingsWrapper.toolbarSettings.echosign_dev1__Update_Status__c, agreementWrapper.isInFlightStatus ) }">
                                                <li id="menu-2-2" class="slds-dropdown__item" role="menuitem option" tabindex="-1"><a data-order="{! agreementWrapper.agreement.Id }" onclick="{! c.onAgreementUpdate }" tabindex="-1" class="slds-truncate">Update Status</a></li>
                                            </aura:if>
                                            <aura:if isTrue="{! and( v.settingsWrapper.toolbarSettings.echosign_dev1__View_Agreement__c, !agreementWrapper.isNotSentStatus ) }">
                                                <li id="menu-2-2" class="slds-dropdown__item" role="menuitem option" tabindex="-1"><a data-order="{! agreementWrapper.agreement.Id }" onclick="{! c.onAgreementView }" tabindex="-1" class="slds-truncate">View Agreement</a></li>
                                            </aura:if>
                                            <aura:if isTrue="{! v.settingsWrapper.toolbarSettings.echosign_dev1__Delete_Agreement__c }">
                                                <li id="menu-2-2" class="slds-dropdown__item" role="menuitem option" tabindex="-1"><a data-order="{! agreementWrapper.agreement.Id }" onclick="{! c.onAgreementDelete }" tabindex="-1" class="slds-truncate">Delete Agreement</a></li>
                                            </aura:if>
                                            <aura:if isTrue="{! and( v.settingsWrapper.toolbarSettings.echosign_dev1__Cancel_Agreement__c, agreementWrapper.isInFlightStatus ) }">
                                                <li id="menu-2-2" class="slds-dropdown__item" role="menuitem option" tabindex="-1"><a data-order="{! agreementWrapper.agreement.Id }" onclick="{! c.onAgreementCancel }" tabindex="-1" class="slds-truncate">Cancel Agreement</a></li>
                                            </aura:if>
                                        </ul>
                                    </div>
                                </td>
                            </tr>
                        </aura:iteration>
                    </tbody>
                </table>
            </div>
		</aura:if>
        </div>
    </div>
</aura:component>